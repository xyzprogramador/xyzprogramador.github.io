<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SFOTH Community Forum</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    body {
      background: #0d0d0d;
      font-family: 'Press Start 2P', monospace;
      color: #00ff90;
      padding: 20px;
      text-shadow: 1px 1px 0 #000;
    }
    nav {
      text-align: center;
      margin-bottom: 20px;
    }
    nav a {
      color: #00ff90;
      margin: 0 15px;
      text-decoration: none;
    }
    .container {
      background: rgba(0, 0, 0, 0.8);
      border: 4px solid #00ff90;
      padding: 20px;
      max-width: 900px;
      margin: auto;
      border-radius: 8px;
    }
    h1 {
      color: #ffffff;
      font-size: 18px;
      text-align: center;
      margin-bottom: 20px;
    }
    .post {
      background: #111;
      border: 2px dashed #00ff90;
      padding: 15px;
      margin-bottom: 15px;
      font-size: 12px;
    }
    .post-title {
      color: #ffcc00;
      margin-bottom: 5px;
    }
    .post-meta {
      font-size: 10px;
      color: #999;
      margin-bottom: 8px;
    }
    .post-content {
      line-height: 1.6;
    }
    form {
      border: 2px dashed #00ff90;
      padding: 15px;
      background: #111;
      margin-bottom: 30px;
    }
    input, textarea, button {
      font-family: 'Press Start 2P', monospace;
      font-size: 10px;
      padding: 8px;
      margin: 5px 0;
      background: #000;
      color: #00ff90;
      border: 2px solid #00ff90;
      width: 100%;
    }
    button {
      cursor: pointer;
    }
    footer {
      text-align: center;
      font-size: 10px;
      margin-top: 20px;
      color: #888;
    }
  </style>
</head>
<body>

  <nav>
    <a href="index.html">üè† Home</a>
    <a href="forum.html">üí¨ Forum</a>
  </nav>

  <div class="container">
    <h1>üí¨ SFOTH IV Community Forum</h1>

    <form id="postForm">
      <input type="text" id="username" placeholder="Your name" required />
      <input type="text" id="title" placeholder="Post title" required />
      <textarea id="content" placeholder="Your post..." required rows="4"></textarea>
      <button type="submit">üì® Post</button>
    </form>

    <div id="posts"></div>

    <footer>
      Forum powered by Shedletsky's Eternal Legacy | Posts saved locally | ¬© 2025
    </footer>
  </div>

<script>
  const postForm = document.getElementById('postForm');
  const postsContainer = document.getElementById('posts');

  const adminUsers = ["caique9014", "ZIP", "MutualDumbass"];
  const adminPassword = "sfothlikers";
  let isAdmin = false;

  // Create password field (initially hidden)
  const passwordInput = document.createElement("input");
  passwordInput.type = "password";
  passwordInput.id = "adminPassword";
  passwordInput.placeholder = "Enter admin password";
  passwordInput.style.display = "none";
  postForm.insertBefore(passwordInput, postForm.querySelector('textarea'));

  // Detect admin username input
  const usernameInput = document.getElementById('username');
  usernameInput.addEventListener('input', () => {
    const uname = usernameInput.value.trim();
    if (adminUsers.includes(uname)) {
      passwordInput.style.display = "block";
    } else {
      passwordInput.style.display = "none";
      passwordInput.value = "";
    }
  });

  function loadPosts() {
    const posts = JSON.parse(localStorage.getItem('forumPosts')) || [];
    postsContainer.innerHTML = '';
    posts.reverse().forEach((post, index) => {
      const postDiv = document.createElement('div');
      postDiv.className = 'post';
      postDiv.innerHTML = `
        <div class="post-title">${post.title}</div>
        <div class="post-meta">Posted by ${post.user} on ${post.date}</div>
        <div class="post-content">${post.content}</div>
      `;

      // Admin delete button
      if (isAdmin) {
        const delBtn = document.createElement('button');
        delBtn.textContent = "üóëÔ∏è Delete";
        delBtn.style.marginTop = "10px";
        delBtn.style.background = "#ff4444";
        delBtn.style.border = "2px solid #fff";
        delBtn.style.color = "#fff";
        delBtn.style.cursor = "pointer";
        delBtn.style.fontSize = "10px";
        delBtn.onclick = () => {
          if (confirm("Are you sure you want to delete this post?")) {
            const originalPosts = JSON.parse(localStorage.getItem('forumPosts')) || [];
            originalPosts.splice(originalPosts.length - 1 - index, 1); // Remove correct index (because of reverse)
            localStorage.setItem('forumPosts', JSON.stringify(originalPosts));
            loadPosts();
          }
        };
        postDiv.appendChild(delBtn);
      }

      postsContainer.appendChild(postDiv);
    });
  }

  postForm.addEventListener('submit', (e) => {
    e.preventDefault();

    const user = document.getElementById('username').value.trim();
    const title = document.getElementById('title').value.trim();
    const content = document.getElementById('content').value.trim();
    const pwd = passwordInput.value.trim();

    if (!user || !title || !content) return;

    if (adminUsers.includes(user)) {
      if (pwd === adminPassword) {
        isAdmin = true;
      } else {
        alert("‚ùå Incorrect password for admin user.");
        return;
      }
    }

    const post = {
      user,
      title,
      content,
      date: new Date().toLocaleString(),
    };

    const posts = JSON.parse(localStorage.getItem('forumPosts')) || [];
    posts.push(post);
    localStorage.setItem('forumPosts', JSON.stringify(posts));

    postForm.reset();
    passwordInput.style.display = "none";
    loadPosts();
  });

  // Load posts on first visit
  loadPosts();
</script>


</body>
</html>
